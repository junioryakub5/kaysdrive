generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =============================================================================
// MODELS (PostgreSQL compatible - using String instead of enums for flexibility)
// =============================================================================

model Car {
  id           String   @id @default(uuid())
  slug         String   @unique
  title        String
  price        Float
  priceType    String   @default("FIXED") // FIXED, PER_WEEK, PER_MONTH
  status       String   @default("FOREIGN_USED") // FOREIGN_USED, GHANA_USED
  category     String
  manufacturer String
  year         Int
  mileage      Int
  engine       String
  fuel         String   @default("GASOLINE") // GASOLINE, DIESEL, ELECTRIC, HYBRID
  transmission String   @default("AUTOMATIC") // AUTOMATIC, MANUAL
  city         String
  images       String   @default("[]") // JSON array
  features     String   @default("[]") // JSON array
  description  String
  isPublished  Boolean  @default(true)
  isFeatured   Boolean  @default(false)
  isSold       Boolean  @default(false)
  agentId      String
  agent        Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([status])
  @@index([manufacturer])
  @@index([isPublished])
  @@index([isFeatured])
  @@index([isSold])
}

model Agent {
  id       String  @id @default(uuid())
  name     String
  role     String
  phone    String
  email    String  @unique
  password String?
  avatar   String?
  bio      String?
  socials  String  @default("[]") // JSON array
  isActive Boolean @default(true)
  cars     Car[]

  @@index([isActive])
}


model Service {
  id          String  @id @default(uuid())
  title       String
  description String
  icon        String
  features    String  @default("[]") // JSON array
  sortOrder   Int     @default(0)
  isActive    Boolean @default(true)

  @@index([isActive])
  @@index([sortOrder])
}

model FAQ {
  id        String  @id @default(uuid())
  question  String
  answer    String
  category  String?
  sortOrder Int     @default(0)
  isActive  Boolean @default(true)

  @@index([category])
  @@index([isActive])
}

model Testimonial {
  id       String  @id @default(uuid())
  name     String
  role     String
  avatar   String?
  content  String
  rating   Int     @default(5)
  isActive Boolean @default(true)

  @@index([isActive])
}

model Brand {
  id        String  @id @default(uuid())
  name      String
  logo      String
  sortOrder Int     @default(0)
  isActive  Boolean @default(true)

  @@index([isActive])
  @@index([sortOrder])
}

model ContactSubmission {
  id        String   @id @default(uuid())
  name      String
  email     String
  phone     String?
  subject   String
  message   String
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([isRead])
  @@index([createdAt])
}

model SiteSettings {
  id       String @id @default("default")
  siteName String @default("Carz")
  phone    String @default("")
  email    String @default("")
  address  String @default("")
  socials  String @default("[]") // JSON array
}

model PageView {
  id        String   @id @default(uuid())
  ipHash    String   // Hashed IP for privacy
  userAgent String?  // Browser user agent
  page      String   // Page URL/path
  referrer  String?  // Where they came from
  createdAt DateTime @default(now())

  @@index([createdAt])
  @@index([page])
  @@index([ipHash, createdAt])
}

model Admin {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String
  role      String   @default("ADMIN") // ADMIN, SUPER_ADMIN
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())

  @@index([email])
  @@index([isActive])
}
